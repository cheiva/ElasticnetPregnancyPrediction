*仓库不含原始数据，已替换为模拟数据

## 概述

基于孕妇代谢组学数据，利用Elastic Net算法构建了多分类模型，并针对高维小样本的数据特点通过预处理、特征筛选和参数优化，区分正常妊娠（normal）、自发性早产（sPL）和胎膜早破（pPROM）。
在测试集上取得了 **84.38%** 的整体准确率（95% CI: 67.21%-94.72%），Kappa系数为 **0.7664**。并对关键代谢标志物的重要性进行排列，为早产亚型的早期预测提供了新的生物标志物组合。

与Random Forest等模型相比，弹性网络在本场景下表现出显著优势，是处理此类数据更为有效的解决方案。

## 目录结构

```
sPL-pPROM/
├── data/             # 数据目录
│   ├── raw/          # 原始数据
│   └── processed/    # 预处理后的数据
├── scripts/              # 源代码
│   └── ElasticNet.R  # 预处理、建模、评估
└── results/          # 输出结果
    ├── figures/      # 图表（如热力图、ROC曲线、特征重要性图）
    └── models/       # 模型文件
```

## 流程

### 1. 数据预处理

- **数据整合与标注**：合并代谢组学数据与临床分组信息。
- **标准化**：使用训练集参数（均值、方差）对训练集和测试集进行Z-score标准化，以消除量纲差异。
- **特征预筛选**：应用方差过滤法，剔除低方差代谢物特征，降低维度。

### 2. 模型构建与训练

- **算法选择**：采用适用于高维数据的Elastic Net。
- **参数优化**：设置了扩展的正则化参数lambda网格进行搜索。
- **训练方法**：使用5折交叉验证重复5次，以稳健评估模型性能并减轻过拟合。

### 3. 模型评估与解释

- **性能评估**：在预留的测试集上计算准确率、Kappa系数及置信区间，并绘制混淆矩阵热力图和ROC曲线。
- **特征提取**：从模型中提取重要性排名前19的代谢物，并可视化其贡献度。

